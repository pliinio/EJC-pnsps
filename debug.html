<!DOCTYPE html>
<html>
<head>
    <title>TESTE SIMPLES - Diagn√≥stico</title>
    <style>
        body { margin: 0; padding: 20px; background: #000; color: white; font-family: Arial; }
        .teste { background: #333; padding: 20px; margin: 10px; border-radius: 10px; }
        .sucesso { border-left: 5px solid green; }
        .erro { border-left: 5px solid red; }
        button { background: gold; color: black; padding: 10px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîß TESTE DE DIAGN√ìSTICO</h1>
    
    <div class="teste">
        <h3>1. Teste de Arquivos</h3>
        <button onclick="testarArquivos()">Verificar Arquivos</button>
        <div id="arquivos"></div>
    </div>

    <div class="teste">
        <h3>2. Teste de Three.js B√°sico</h3>
        <button onclick="testarThreeJS()">Testar Three.js</button>
        <div id="threejs" style="width: 300px; height: 200px; background: #111; margin: 10px 0;"></div>
    </div>

    <div class="teste">
        <h3>3. Teste de MindAR B√°sico</h3>
        <button onclick="testarMindAR()">Testar MindAR</button>
        <div id="mindar" style="width: 100%; height: 400px; background: #111; margin: 10px 0;"></div>
    </div>

    <div id="resultado" style="margin-top: 20px; padding: 15px; background: #222; border-radius: 10px;"></div>

    <script>
        async function testarArquivos() {
            const div = document.getElementById('arquivos');
            div.innerHTML = 'Verificando...';
            
            const arquivos = [
                './targets.mind',
                './assets/models/altar-compressed.glb', 
                './assets/models/livro-compressed.glb'
            ];
            
            let resultados = '';
            
            for (const arquivo of arquivos) {
                try {
                    const response = await fetch(arquivo);
                    if (response.ok) {
                        const size = (await response.blob()).size;
                        resultados += `<div class="sucesso">‚úÖ ${arquivo} - ${(size/1024).toFixed(1)}KB</div>`;
                    } else {
                        resultados += `<div class="erro">‚ùå ${arquivo} - ERRO ${response.status}</div>`;
                    }
                } catch (error) {
                    resultados += `<div class="erro">‚ùå ${arquivo} - ${error.message}</div>`;
                }
            }
            
            div.innerHTML = resultados;
        }

        function testarThreeJS() {
            const div = document.getElementById('threejs');
            
            try {
                // Verificar se Three.js est√° dispon√≠vel
                if (typeof THREE === 'undefined') {
                    div.innerHTML = '‚ùå THREE n√£o carregou';
                    return;
                }
                
                // Cena simples
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, 300/200, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer();
                renderer.setSize(300, 200);
                div.innerHTML = '';
                div.appendChild(renderer.domElement);
                
                // Cubo simples
                const geometry = new THREE.BoxGeometry();
                const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                const cube = new THREE.Mesh(geometry, material);
                scene.add(cube);
                camera.position.z = 5;
                
                // Animar
                function animate() {
                    requestAnimationFrame(animate);
                    cube.rotation.x += 0.01;
                    cube.rotation.y += 0.01;
                    renderer.render(scene, camera);
                }
                animate();
                
                div.innerHTML += '<div class="sucesso">‚úÖ Three.js FUNCIONANDO</div>';
            } catch (error) {
                div.innerHTML = `<div class="erro">‚ùå Three.js ERRO: ${error.message}</div>`;
            }
        }

        async function testarMindAR() {
            const div = document.getElementById('mindar');
            div.innerHTML = 'Carregando MindAR...';
            
            try {
                // Carregar Three.js e MindAR dinamicamente
                const threeScript = document.createElement('script');
                threeScript.src = 'https://unpkg.com/three@0.160.0/build/three.min.js';
                
                threeScript.onload = async () => {
                    const mindarScript = document.createElement('script');
                    mindarScript.src = 'https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js';
                    
                    mindarScript.onload = async () => {
                        try {
                            const mindarThree = new MindARThree({
                                container: div,
                                imageTargetSrc: "./targets.mind",
                            });
                            
                            const { renderer, scene, camera } = mindarThree;
                            
                            // Cubo vermelho como teste
                            const anchor = mindarThree.addAnchor(0);
                            const geometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);
                            const material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
                            const cube = new THREE.Mesh(geometry, material);
                            anchor.group.add(cube);
                            
                            await mindarThree.start();
                            renderer.setAnimationLoop(() => {
                                renderer.render(scene, camera);
                            });
                            
                            div.innerHTML += '<div class="sucesso">‚úÖ MindAR INICIADO - Aponte a c√¢mera para o marcador</div>';
                            
                        } catch (error) {
                            div.innerHTML = `<div class="erro">‚ùå MindAR ERRO: ${error.message}</div>`;
                        }
                    };
                    
                    mindarScript.onerror = () => {
                        div.innerHTML = '<div class="erro">‚ùå N√£o foi carregar MindAR</div>';
                    };
                    
                    document.head.appendChild(mindarScript);
                };
                
                threeScript.onerror = () => {
                    div.innerHTML = '<div class="erro">‚ùå N√£o foi carregar Three.js</div>';
                };
                
                document.head.appendChild(threeScript);
                
            } catch (error) {
                div.innerHTML = `<div class="erro">‚ùå ERRO: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
