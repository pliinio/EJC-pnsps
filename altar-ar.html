<script>
  const sceneEl = document.querySelector('a-scene');
  const anchor = document.querySelector('#altar-anchor');
  const altar = document.querySelector('#altar');

  let alreadyPlaced = false;

  // começa invisível
  altar.object3D.visible = false;

  sceneEl.addEventListener("targetFound", () => {
    if (alreadyPlaced) return; // não repetir processo

    alreadyPlaced = true;

    // mostrar altar e iniciar animação suave
    altar.setAttribute("animation__grow", {
      property: "scale",
      from: "0 0 0",
      to: "0.4 0.4 0.4",
      dur: 1000,
      easing: "easeOutElastic"
    });
    altar.object3D.visible = true;

    // FIXAR altar permanentemente
    sceneEl.systems["mindar-image-system"].stop(); // para scanner
    document.querySelector(".mindar-ui-overlay")?.remove(); // remove UI do mindar

    // copiar posição final do anchor
    const pos = anchor.object3D.position.clone();
    const rot = anchor.object3D.rotation.clone();
    const scale = anchor.object3D.scale.clone();

    // remover anchor e mover altar para a cena principal
    anchor.parentNode.removeChild(anchor);

    altar.object3D.position.copy(pos);
    altar.object3D.rotation.copy(rot);
    altar.object3D.scale.copy(scale);

    sceneEl.object3D.add(altar.object3D);
  });

  // nunca esconder o altar
  sceneEl.addEventListener("targetLost", () => {
    // ignorado de propósito
  });
</script>
